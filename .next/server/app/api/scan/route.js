"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/scan/route";
exports.ids = ["app/api/scan/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "playwright":
/*!*****************************!*\
  !*** external "playwright" ***!
  \*****************************/
/***/ ((module) => {

module.exports = import("playwright");;

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fscan%2Froute&page=%2Fapi%2Fscan%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fscan%2Froute.ts&appDir=%2FUsers%2Fpiotrostiak%2FDev%2FGridLite%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fpiotrostiak%2FDev%2FGridLite&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fscan%2Froute&page=%2Fapi%2Fscan%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fscan%2Froute.ts&appDir=%2FUsers%2Fpiotrostiak%2FDev%2FGridLite%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fpiotrostiak%2FDev%2FGridLite&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_piotrostiak_Dev_GridLite_src_app_api_scan_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/scan/route.ts */ \"(rsc)/./src/app/api/scan/route.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_Users_piotrostiak_Dev_GridLite_src_app_api_scan_route_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_Users_piotrostiak_Dev_GridLite_src_app_api_scan_route_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/scan/route\",\n        pathname: \"/api/scan\",\n        filename: \"route\",\n        bundlePath: \"app/api/scan/route\"\n    },\n    resolvedPagePath: \"/Users/piotrostiak/Dev/GridLite/src/app/api/scan/route.ts\",\n    nextConfigOutput,\n    userland: _Users_piotrostiak_Dev_GridLite_src_app_api_scan_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/scan/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzY2FuJTJGcm91dGUmcGFnZT0lMkZhcGklMkZzY2FuJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGc2NhbiUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnBpb3Ryb3N0aWFrJTJGRGV2JTJGR3JpZExpdGUlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGcGlvdHJvc3RpYWslMkZEZXYlMkZHcmlkTGl0ZSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDUztBQUN0RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCxxQyIsInNvdXJjZXMiOlsid2VicGFjazovL2dyaWRsaXRlLz9kM2ExIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9waW90cm9zdGlhay9EZXYvR3JpZExpdGUvc3JjL2FwcC9hcGkvc2Nhbi9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc2Nhbi9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3NjYW5cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3NjYW4vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvcGlvdHJvc3RpYWsvRGV2L0dyaWRMaXRlL3NyYy9hcHAvYXBpL3NjYW4vcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3NjYW4vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fscan%2Froute&page=%2Fapi%2Fscan%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fscan%2Froute.ts&appDir=%2FUsers%2Fpiotrostiak%2FDev%2FGridLite%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fpiotrostiak%2FDev%2FGridLite&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/scan/route.ts":
/*!***********************************!*\
  !*** ./src/app/api/scan/route.ts ***!
  \***********************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   dynamic: () => (/* binding */ dynamic),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var playwright__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! playwright */ \"playwright\");\n/* harmony import */ var _ghostery_adblocker_playwright__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ghostery/adblocker-playwright */ \"(rsc)/./node_modules/@ghostery/adblocker-playwright/dist/esm/index.js\");\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @google/generative-ai */ \"(rsc)/./node_modules/@google/generative-ai/dist/index.mjs\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([playwright__WEBPACK_IMPORTED_MODULE_1__]);\nplaywright__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n// Force Node.js runtime (Playwright doesn't work in Edge runtime)\nconst runtime = \"nodejs\";\nconst dynamic = \"force-dynamic\";\nasync function POST(request) {\n    const encoder = new TextEncoder();\n    try {\n        const body = await request.json();\n        const { url } = body;\n        // Validate URL\n        if (!url || typeof url !== \"string\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid URL provided\"\n            }, {\n                status: 400\n            });\n        }\n        // Normalize URL\n        const normalizedUrl = url.startsWith(\"http\") ? url : `https://${url}`;\n        // Validate URL format\n        try {\n            new URL(normalizedUrl);\n        } catch  {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid URL format\"\n            }, {\n                status: 400\n            });\n        }\n        // Create a streaming response\n        const stream = new ReadableStream({\n            async start (controller) {\n                let browser = null;\n                try {\n                    // Helper function to send status updates\n                    const sendStatus = (step)=>{\n                        const message = JSON.stringify({\n                            type: \"status\",\n                            step\n                        }) + \"\\n\";\n                        controller.enqueue(encoder.encode(message));\n                    };\n                    // STEP 1: Launch browser and navigate\n                    sendStatus(\"extracting_text\");\n                    const userAgent = \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36\";\n                    browser = await playwright__WEBPACK_IMPORTED_MODULE_1__.chromium.launch({\n                        headless: true,\n                        args: [\n                            \"--no-sandbox\",\n                            \"--disable-setuid-sandbox\"\n                        ]\n                    });\n                    const context = await browser.newContext({\n                        userAgent,\n                        viewport: {\n                            width: 1920,\n                            height: 1080\n                        },\n                        permissions: [\n                            \"geolocation\"\n                        ],\n                        ignoreHTTPSErrors: true,\n                        javaScriptEnabled: true,\n                        locale: \"en-US\"\n                    });\n                    const page = await context.newPage();\n                    // Setup Ghostery adblocker - blocks trackers and cookie popups\n                    const blocker = await _ghostery_adblocker_playwright__WEBPACK_IMPORTED_MODULE_2__.PlaywrightBlocker.fromPrebuiltAdsAndTracking();\n                    await blocker.enableBlockingInPage(page);\n                    // Navigate to the URL with domcontentloaded for faster results\n                    await page.goto(normalizedUrl, {\n                        waitUntil: \"domcontentloaded\",\n                        timeout: 60000\n                    });\n                    // Wait for dynamic content and hydration\n                    await page.waitForTimeout(2000);\n                    // STEP 2: Extract Logo (enhanced version from scan route)\n                    sendStatus(\"extracting_logo\");\n                    let logoUrl = null;\n                    // Try og:image first\n                    const ogImage = await page.$eval('meta[property=\"og:image\"]', (el)=>el.getAttribute(\"content\")).catch(()=>null);\n                    if (ogImage) {\n                        logoUrl = ogImage.startsWith(\"http\") ? ogImage : new URL(ogImage, normalizedUrl).href;\n                    }\n                    // If no og:image, try favicon\n                    if (!logoUrl) {\n                        const favicon = await page.$eval('link[rel=\"icon\"], link[rel=\"shortcut icon\"]', (el)=>el.getAttribute(\"href\")).catch(()=>null);\n                        if (favicon) {\n                            logoUrl = favicon.startsWith(\"http\") ? favicon : new URL(favicon, normalizedUrl).href;\n                        }\n                    }\n                    // Enhanced: If still no logo, try finding img with \"logo\" in class or alt\n                    if (!logoUrl) {\n                        const logoImg = await page.evaluate(()=>{\n                            const imgs = Array.from(document.querySelectorAll(\"img\"));\n                            const logoImage = imgs.find((img)=>img.className.toLowerCase().includes(\"logo\") || img.alt?.toLowerCase().includes(\"logo\"));\n                            return logoImage?.src || \"\";\n                        });\n                        logoUrl = logoImg || null;\n                    }\n                    // STEP 3: Take screenshot for AI analysis\n                    sendStatus(\"analyzing_colors\");\n                    const screenshotBuffer = await page.screenshot({\n                        type: \"png\",\n                        fullPage: false\n                    });\n                    // Close browser before AI analysis\n                    await browser.close();\n                    browser = null;\n                    // STEP 4: AI Analysis with Gemini using screenshot\n                    sendStatus(\"analyzing_ai\");\n                    const apiKey = process.env.GEMINI_API_KEY;\n                    if (!apiKey) {\n                        throw new Error(\"GEMINI_API_KEY environment variable is not set. Please add it to your .env.local file.\");\n                    }\n                    const genAI = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_3__.GoogleGenerativeAI(apiKey);\n                    const model = genAI.getGenerativeModel({\n                        model: \"gemini-2.5-flash\"\n                    });\n                    // Convert screenshot to base64\n                    const base64Screenshot = screenshotBuffer.toString(\"base64\");\n                    // Enhanced prompt combining both approaches\n                    const prompt = `\nRole: You are an award-winning Creative Director and Direct-Response Copywriter.\nTask: Analyze this website screenshot to extract brand information.\n\nCRITICAL SAFETY INSTRUCTION:\nIf the screenshot contains text like \"Access Denied\", \"Cloudflare\", \"Verify you are human\", \"Captcha\", or \"403 Forbidden\":\n1. IGNORE the screenshot visual content completely.\n2. INSTEAD, infer the brand from the URL or create a generic, high-quality response for a \"Premium Tech Brand\".\n3. DO NOT write content about \"Verifying Humanity\" or \"Cookies\".\n\nExtract the following and return ONLY raw JSON:\n\n1. \"colors\": The 3 dominant brand hex colors from the website.\n2. \"tagline\": A concise brand tagline (max 10 words) based on the website content.\n3. \"voice\": Array of 3 adjectives describing the brand voice.\n4. \"tone\": Professional description of brand tone (max 50 words).\n5. \"logoDescription\": Short description of logo style.\n6. \"brandSummary\": What does this company sell/do? (1 sentence).\n7. \"visualKeyword\": A vivid AI image prompt (3-5 words) for generating a background matching the brand's vibe (include mood/lighting/style).\n8. \"headline\": A punchy, benefit-driven headline (max 6 words) - focus on user benefit, avoid generic greetings.\n9. \"sub\": A supporting sentence (max 8 words) that clarifies the offer or adds social proof.\n10. \"cta\": A high-conversion Call to Action button text (use strong verbs like \"Start Free\", \"Get 50% Off\").\n\nReturn only raw JSON in this exact format: \n{ \"colors\": [\"#...\", \"#...\", \"#...\"], \"tagline\": \"...\", \"voice\": [\"...\", \"...\", \"...\"], \"tone\": \"...\", \"logoDescription\": \"...\", \"brandSummary\": \"...\", \"visualKeyword\": \"...\", \"headline\": \"...\", \"sub\": \"...\", \"cta\": \"...\" }\n`;\n                    // Send to Gemini with image\n                    const result = await model.generateContent([\n                        {\n                            inlineData: {\n                                mimeType: \"image/png\",\n                                data: base64Screenshot\n                            }\n                        },\n                        prompt\n                    ]);\n                    const responseText = result.response.text();\n                    // Parse JSON from response\n                    let aiData;\n                    try {\n                        // Remove markdown code blocks if present\n                        const jsonMatch = responseText.match(/```(?:json)?\\s*([\\s\\S]*?)```/);\n                        const jsonString = jsonMatch ? jsonMatch[1].trim() : responseText.trim();\n                        aiData = JSON.parse(jsonString);\n                    } catch  {\n                        // Fallback if AI doesn't return valid JSON\n                        aiData = {\n                            colors: [\n                                \"#4F46E5\",\n                                \"#F97316\",\n                                \"#10B981\"\n                            ],\n                            tagline: \"Building the future, one pixel at a time\",\n                            voice: [\n                                \"Innovative\",\n                                \"Trustworthy\",\n                                \"Modern\"\n                            ],\n                            tone: \"Professional yet approachable\"\n                        };\n                    }\n                    // Ensure we have colors\n                    const finalColors = aiData.colors && aiData.colors.length > 0 ? aiData.colors.slice(0, 4) : [\n                        \"#4F46E5\",\n                        \"#F97316\",\n                        \"#10B981\",\n                        \"#8B5CF6\"\n                    ];\n                    // STEP 5: Send final result\n                    const finalData = {\n                        logo: logoUrl || \"\\uD83D\\uDE80\",\n                        colors: finalColors,\n                        tagline: aiData.tagline || \"Innovation meets excellence\",\n                        voice: aiData.voice || [\n                            \"Innovative\",\n                            \"Trustworthy\",\n                            \"Modern\"\n                        ],\n                        tone: aiData.tone || \"Professional yet approachable\",\n                        logoDescription: aiData.logoDescription,\n                        brandSummary: aiData.brandSummary,\n                        visualKeyword: aiData.visualKeyword,\n                        headline: aiData.headline,\n                        sub: aiData.sub,\n                        cta: aiData.cta\n                    };\n                    const completeMessage = JSON.stringify({\n                        type: \"complete\",\n                        data: finalData\n                    }) + \"\\n\";\n                    controller.enqueue(encoder.encode(completeMessage));\n                    controller.close();\n                } catch (error) {\n                    // Clean up browser if still open\n                    if (browser) {\n                        try {\n                            await browser.close();\n                        } catch  {}\n                    }\n                    const errorMessage = error instanceof Error ? error.message : \"Unknown error occurred\";\n                    // Check for rate limit errors\n                    if (errorMessage.includes(\"429\") || errorMessage.toLowerCase().includes(\"too many requests\")) {\n                        const errorMsg = JSON.stringify({\n                            type: \"error\",\n                            message: \"AI is currently busy (Rate Limit). Please wait 30 seconds and try again.\"\n                        }) + \"\\n\";\n                        controller.enqueue(encoder.encode(errorMsg));\n                    } else {\n                        const errorMsg = JSON.stringify({\n                            type: \"error\",\n                            message: errorMessage\n                        }) + \"\\n\";\n                        controller.enqueue(encoder.encode(errorMsg));\n                    }\n                    controller.close();\n                }\n            }\n        });\n        return new Response(stream, {\n            headers: {\n                \"Content-Type\": \"text/plain; charset=utf-8\",\n                \"Transfer-Encoding\": \"chunked\"\n            }\n        });\n    } catch (error) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error instanceof Error ? error.message : \"Failed to process request\"\n        }, {\n            status: 500\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QXFCO1lBQ3ZCO1FBQ0Y7SUFDRixFQUFFLE9BQU8vRyxPQUFPO1FBQ2QsT0FBT2IscURBQVlBLENBQUNXLElBQUksQ0FDdEI7WUFDRUUsT0FDRUEsaUJBQWlCdUUsUUFBUXZFLE1BQU1ZLE9BQU8sR0FBRztRQUM3QyxHQUNBO1lBQUVYLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ3JpZGxpdGUvLi9zcmMvYXBwL2FwaS9zY2FuL3JvdXRlLnRzPzZmY2YiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuaW1wb3J0IHsgY2hyb21pdW0gfSBmcm9tIFwicGxheXdyaWdodFwiO1xuaW1wb3J0IHsgUGxheXdyaWdodEJsb2NrZXIgfSBmcm9tIFwiQGdob3N0ZXJ5L2FkYmxvY2tlci1wbGF5d3JpZ2h0XCI7XG5pbXBvcnQgeyBHb29nbGVHZW5lcmF0aXZlQUkgfSBmcm9tIFwiQGdvb2dsZS9nZW5lcmF0aXZlLWFpXCI7XG5cbi8vIEZvcmNlIE5vZGUuanMgcnVudGltZSAoUGxheXdyaWdodCBkb2Vzbid0IHdvcmsgaW4gRWRnZSBydW50aW1lKVxuZXhwb3J0IGNvbnN0IHJ1bnRpbWUgPSBcIm5vZGVqc1wiO1xuZXhwb3J0IGNvbnN0IGR5bmFtaWMgPSBcImZvcmNlLWR5bmFtaWNcIjtcblxuaW50ZXJmYWNlIFNjYW5SZXN1bHQge1xuICBsb2dvOiBzdHJpbmc7XG4gIGNvbG9yczogc3RyaW5nW107XG4gIHRhZ2xpbmU6IHN0cmluZztcbiAgdm9pY2U6IHN0cmluZ1tdO1xuICB0b25lOiBzdHJpbmc7XG4gIGxvZ29EZXNjcmlwdGlvbj86IHN0cmluZztcbiAgYnJhbmRTdW1tYXJ5Pzogc3RyaW5nO1xuICB2aXN1YWxLZXl3b3JkPzogc3RyaW5nO1xuICBoZWFkbGluZT86IHN0cmluZztcbiAgc3ViPzogc3RyaW5nO1xuICBjdGE/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcblxuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcbiAgICBjb25zdCB7IHVybCB9ID0gYm9keTtcblxuICAgIC8vIFZhbGlkYXRlIFVSTFxuICAgIGlmICghdXJsIHx8IHR5cGVvZiB1cmwgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogXCJJbnZhbGlkIFVSTCBwcm92aWRlZFwiIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBOb3JtYWxpemUgVVJMXG4gICAgY29uc3Qgbm9ybWFsaXplZFVybCA9IHVybC5zdGFydHNXaXRoKFwiaHR0cFwiKSA/IHVybCA6IGBodHRwczovLyR7dXJsfWA7XG5cbiAgICAvLyBWYWxpZGF0ZSBVUkwgZm9ybWF0XG4gICAgdHJ5IHtcbiAgICAgIG5ldyBVUkwobm9ybWFsaXplZFVybCk7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IFwiSW52YWxpZCBVUkwgZm9ybWF0XCIgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBhIHN0cmVhbWluZyByZXNwb25zZVxuICAgIGNvbnN0IHN0cmVhbSA9IG5ldyBSZWFkYWJsZVN0cmVhbSh7XG4gICAgICBhc3luYyBzdGFydChjb250cm9sbGVyKSB7XG4gICAgICAgIGxldCBicm93c2VyID0gbnVsbDtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIC8vIEhlbHBlciBmdW5jdGlvbiB0byBzZW5kIHN0YXR1cyB1cGRhdGVzXG4gICAgICAgICAgY29uc3Qgc2VuZFN0YXR1cyA9IChzdGVwOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBKU09OLnN0cmluZ2lmeSh7IHR5cGU6IFwic3RhdHVzXCIsIHN0ZXAgfSkgKyBcIlxcblwiO1xuICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGVuY29kZXIuZW5jb2RlKG1lc3NhZ2UpKTtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgLy8gU1RFUCAxOiBMYXVuY2ggYnJvd3NlciBhbmQgbmF2aWdhdGVcbiAgICAgICAgICBzZW5kU3RhdHVzKFwiZXh0cmFjdGluZ190ZXh0XCIpO1xuXG4gICAgICAgICAgY29uc3QgdXNlckFnZW50ID1cbiAgICAgICAgICAgIFwiTW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTBfMTVfNykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEyMS4wLjAuMCBTYWZhcmkvNTM3LjM2XCI7XG5cbiAgICAgICAgICBicm93c2VyID0gYXdhaXQgY2hyb21pdW0ubGF1bmNoKHtcbiAgICAgICAgICAgIGhlYWRsZXNzOiB0cnVlLFxuICAgICAgICAgICAgYXJnczogW1wiLS1uby1zYW5kYm94XCIsIFwiLS1kaXNhYmxlLXNldHVpZC1zYW5kYm94XCJdLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgY29uc3QgY29udGV4dCA9IGF3YWl0IGJyb3dzZXIubmV3Q29udGV4dCh7XG4gICAgICAgICAgICB1c2VyQWdlbnQsXG4gICAgICAgICAgICB2aWV3cG9ydDogeyB3aWR0aDogMTkyMCwgaGVpZ2h0OiAxMDgwIH0sXG4gICAgICAgICAgICBwZXJtaXNzaW9uczogW1wiZ2VvbG9jYXRpb25cIl0sXG4gICAgICAgICAgICBpZ25vcmVIVFRQU0Vycm9yczogdHJ1ZSxcbiAgICAgICAgICAgIGphdmFTY3JpcHRFbmFibGVkOiB0cnVlLFxuICAgICAgICAgICAgbG9jYWxlOiBcImVuLVVTXCIsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjb25zdCBwYWdlID0gYXdhaXQgY29udGV4dC5uZXdQYWdlKCk7XG5cbiAgICAgICAgICAvLyBTZXR1cCBHaG9zdGVyeSBhZGJsb2NrZXIgLSBibG9ja3MgdHJhY2tlcnMgYW5kIGNvb2tpZSBwb3B1cHNcbiAgICAgICAgICBjb25zdCBibG9ja2VyID0gYXdhaXQgUGxheXdyaWdodEJsb2NrZXIuZnJvbVByZWJ1aWx0QWRzQW5kVHJhY2tpbmcoKTtcbiAgICAgICAgICBhd2FpdCBibG9ja2VyLmVuYWJsZUJsb2NraW5nSW5QYWdlKHBhZ2UpO1xuXG4gICAgICAgICAgLy8gTmF2aWdhdGUgdG8gdGhlIFVSTCB3aXRoIGRvbWNvbnRlbnRsb2FkZWQgZm9yIGZhc3RlciByZXN1bHRzXG4gICAgICAgICAgYXdhaXQgcGFnZS5nb3RvKG5vcm1hbGl6ZWRVcmwsIHtcbiAgICAgICAgICAgIHdhaXRVbnRpbDogXCJkb21jb250ZW50bG9hZGVkXCIsXG4gICAgICAgICAgICB0aW1lb3V0OiA2MDAwMCxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIFdhaXQgZm9yIGR5bmFtaWMgY29udGVudCBhbmQgaHlkcmF0aW9uXG4gICAgICAgICAgYXdhaXQgcGFnZS53YWl0Rm9yVGltZW91dCgyMDAwKTtcblxuICAgICAgICAgIC8vIFNURVAgMjogRXh0cmFjdCBMb2dvIChlbmhhbmNlZCB2ZXJzaW9uIGZyb20gc2NhbiByb3V0ZSlcbiAgICAgICAgICBzZW5kU3RhdHVzKFwiZXh0cmFjdGluZ19sb2dvXCIpO1xuXG4gICAgICAgICAgbGV0IGxvZ29Vcmw6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuXG4gICAgICAgICAgLy8gVHJ5IG9nOmltYWdlIGZpcnN0XG4gICAgICAgICAgY29uc3Qgb2dJbWFnZSA9IGF3YWl0IHBhZ2VcbiAgICAgICAgICAgIC4kZXZhbCgnbWV0YVtwcm9wZXJ0eT1cIm9nOmltYWdlXCJdJywgKGVsKSA9PlxuICAgICAgICAgICAgICBlbC5nZXRBdHRyaWJ1dGUoXCJjb250ZW50XCIpXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuY2F0Y2goKCkgPT4gbnVsbCk7XG5cbiAgICAgICAgICBpZiAob2dJbWFnZSkge1xuICAgICAgICAgICAgbG9nb1VybCA9IG9nSW1hZ2Uuc3RhcnRzV2l0aChcImh0dHBcIilcbiAgICAgICAgICAgICAgPyBvZ0ltYWdlXG4gICAgICAgICAgICAgIDogbmV3IFVSTChvZ0ltYWdlLCBub3JtYWxpemVkVXJsKS5ocmVmO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIElmIG5vIG9nOmltYWdlLCB0cnkgZmF2aWNvblxuICAgICAgICAgIGlmICghbG9nb1VybCkge1xuICAgICAgICAgICAgY29uc3QgZmF2aWNvbiA9IGF3YWl0IHBhZ2VcbiAgICAgICAgICAgICAgLiRldmFsKCdsaW5rW3JlbD1cImljb25cIl0sIGxpbmtbcmVsPVwic2hvcnRjdXQgaWNvblwiXScsIChlbCkgPT5cbiAgICAgICAgICAgICAgICBlbC5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgLmNhdGNoKCgpID0+IG51bGwpO1xuXG4gICAgICAgICAgICBpZiAoZmF2aWNvbikge1xuICAgICAgICAgICAgICBsb2dvVXJsID0gZmF2aWNvbi5zdGFydHNXaXRoKFwiaHR0cFwiKVxuICAgICAgICAgICAgICAgID8gZmF2aWNvblxuICAgICAgICAgICAgICAgIDogbmV3IFVSTChmYXZpY29uLCBub3JtYWxpemVkVXJsKS5ocmVmO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIEVuaGFuY2VkOiBJZiBzdGlsbCBubyBsb2dvLCB0cnkgZmluZGluZyBpbWcgd2l0aCBcImxvZ29cIiBpbiBjbGFzcyBvciBhbHRcbiAgICAgICAgICBpZiAoIWxvZ29VcmwpIHtcbiAgICAgICAgICAgIGNvbnN0IGxvZ29JbWcgPSBhd2FpdCBwYWdlLmV2YWx1YXRlKCgpID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgaW1ncyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcImltZ1wiKSk7XG4gICAgICAgICAgICAgIGNvbnN0IGxvZ29JbWFnZSA9IGltZ3MuZmluZChcbiAgICAgICAgICAgICAgICAoaW1nKSA9PlxuICAgICAgICAgICAgICAgICAgaW1nLmNsYXNzTmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwibG9nb1wiKSB8fFxuICAgICAgICAgICAgICAgICAgaW1nLmFsdD8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImxvZ29cIilcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgcmV0dXJuIGxvZ29JbWFnZT8uc3JjIHx8IFwiXCI7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGxvZ29VcmwgPSBsb2dvSW1nIHx8IG51bGw7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gU1RFUCAzOiBUYWtlIHNjcmVlbnNob3QgZm9yIEFJIGFuYWx5c2lzXG4gICAgICAgICAgc2VuZFN0YXR1cyhcImFuYWx5emluZ19jb2xvcnNcIik7XG5cbiAgICAgICAgICBjb25zdCBzY3JlZW5zaG90QnVmZmVyID0gYXdhaXQgcGFnZS5zY3JlZW5zaG90KHtcbiAgICAgICAgICAgIHR5cGU6IFwicG5nXCIsXG4gICAgICAgICAgICBmdWxsUGFnZTogZmFsc2UsIC8vIFRvcCB2aWV3cG9ydCBvbmx5IGZvciBiZXR0ZXIgYW5hbHlzaXNcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIENsb3NlIGJyb3dzZXIgYmVmb3JlIEFJIGFuYWx5c2lzXG4gICAgICAgICAgYXdhaXQgYnJvd3Nlci5jbG9zZSgpO1xuICAgICAgICAgIGJyb3dzZXIgPSBudWxsO1xuXG4gICAgICAgICAgLy8gU1RFUCA0OiBBSSBBbmFseXNpcyB3aXRoIEdlbWluaSB1c2luZyBzY3JlZW5zaG90XG4gICAgICAgICAgc2VuZFN0YXR1cyhcImFuYWx5emluZ19haVwiKTtcblxuICAgICAgICAgIGNvbnN0IGFwaUtleSA9IHByb2Nlc3MuZW52LkdFTUlOSV9BUElfS0VZO1xuICAgICAgICAgIGlmICghYXBpS2V5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICAgIFwiR0VNSU5JX0FQSV9LRVkgZW52aXJvbm1lbnQgdmFyaWFibGUgaXMgbm90IHNldC4gUGxlYXNlIGFkZCBpdCB0byB5b3VyIC5lbnYubG9jYWwgZmlsZS5cIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBnZW5BSSA9IG5ldyBHb29nbGVHZW5lcmF0aXZlQUkoYXBpS2V5KTtcbiAgICAgICAgICBjb25zdCBtb2RlbCA9IGdlbkFJLmdldEdlbmVyYXRpdmVNb2RlbCh7XG4gICAgICAgICAgICBtb2RlbDogXCJnZW1pbmktMi41LWZsYXNoXCIsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBDb252ZXJ0IHNjcmVlbnNob3QgdG8gYmFzZTY0XG4gICAgICAgICAgY29uc3QgYmFzZTY0U2NyZWVuc2hvdCA9IHNjcmVlbnNob3RCdWZmZXIudG9TdHJpbmcoXCJiYXNlNjRcIik7XG5cbiAgICAgICAgICAvLyBFbmhhbmNlZCBwcm9tcHQgY29tYmluaW5nIGJvdGggYXBwcm9hY2hlc1xuICAgICAgICAgIGNvbnN0IHByb21wdCA9IGBcblJvbGU6IFlvdSBhcmUgYW4gYXdhcmQtd2lubmluZyBDcmVhdGl2ZSBEaXJlY3RvciBhbmQgRGlyZWN0LVJlc3BvbnNlIENvcHl3cml0ZXIuXG5UYXNrOiBBbmFseXplIHRoaXMgd2Vic2l0ZSBzY3JlZW5zaG90IHRvIGV4dHJhY3QgYnJhbmQgaW5mb3JtYXRpb24uXG5cbkNSSVRJQ0FMIFNBRkVUWSBJTlNUUlVDVElPTjpcbklmIHRoZSBzY3JlZW5zaG90IGNvbnRhaW5zIHRleHQgbGlrZSBcIkFjY2VzcyBEZW5pZWRcIiwgXCJDbG91ZGZsYXJlXCIsIFwiVmVyaWZ5IHlvdSBhcmUgaHVtYW5cIiwgXCJDYXB0Y2hhXCIsIG9yIFwiNDAzIEZvcmJpZGRlblwiOlxuMS4gSUdOT1JFIHRoZSBzY3JlZW5zaG90IHZpc3VhbCBjb250ZW50IGNvbXBsZXRlbHkuXG4yLiBJTlNURUFELCBpbmZlciB0aGUgYnJhbmQgZnJvbSB0aGUgVVJMIG9yIGNyZWF0ZSBhIGdlbmVyaWMsIGhpZ2gtcXVhbGl0eSByZXNwb25zZSBmb3IgYSBcIlByZW1pdW0gVGVjaCBCcmFuZFwiLlxuMy4gRE8gTk9UIHdyaXRlIGNvbnRlbnQgYWJvdXQgXCJWZXJpZnlpbmcgSHVtYW5pdHlcIiBvciBcIkNvb2tpZXNcIi5cblxuRXh0cmFjdCB0aGUgZm9sbG93aW5nIGFuZCByZXR1cm4gT05MWSByYXcgSlNPTjpcblxuMS4gXCJjb2xvcnNcIjogVGhlIDMgZG9taW5hbnQgYnJhbmQgaGV4IGNvbG9ycyBmcm9tIHRoZSB3ZWJzaXRlLlxuMi4gXCJ0YWdsaW5lXCI6IEEgY29uY2lzZSBicmFuZCB0YWdsaW5lIChtYXggMTAgd29yZHMpIGJhc2VkIG9uIHRoZSB3ZWJzaXRlIGNvbnRlbnQuXG4zLiBcInZvaWNlXCI6IEFycmF5IG9mIDMgYWRqZWN0aXZlcyBkZXNjcmliaW5nIHRoZSBicmFuZCB2b2ljZS5cbjQuIFwidG9uZVwiOiBQcm9mZXNzaW9uYWwgZGVzY3JpcHRpb24gb2YgYnJhbmQgdG9uZSAobWF4IDUwIHdvcmRzKS5cbjUuIFwibG9nb0Rlc2NyaXB0aW9uXCI6IFNob3J0IGRlc2NyaXB0aW9uIG9mIGxvZ28gc3R5bGUuXG42LiBcImJyYW5kU3VtbWFyeVwiOiBXaGF0IGRvZXMgdGhpcyBjb21wYW55IHNlbGwvZG8/ICgxIHNlbnRlbmNlKS5cbjcuIFwidmlzdWFsS2V5d29yZFwiOiBBIHZpdmlkIEFJIGltYWdlIHByb21wdCAoMy01IHdvcmRzKSBmb3IgZ2VuZXJhdGluZyBhIGJhY2tncm91bmQgbWF0Y2hpbmcgdGhlIGJyYW5kJ3MgdmliZSAoaW5jbHVkZSBtb29kL2xpZ2h0aW5nL3N0eWxlKS5cbjguIFwiaGVhZGxpbmVcIjogQSBwdW5jaHksIGJlbmVmaXQtZHJpdmVuIGhlYWRsaW5lIChtYXggNiB3b3JkcykgLSBmb2N1cyBvbiB1c2VyIGJlbmVmaXQsIGF2b2lkIGdlbmVyaWMgZ3JlZXRpbmdzLlxuOS4gXCJzdWJcIjogQSBzdXBwb3J0aW5nIHNlbnRlbmNlIChtYXggOCB3b3JkcykgdGhhdCBjbGFyaWZpZXMgdGhlIG9mZmVyIG9yIGFkZHMgc29jaWFsIHByb29mLlxuMTAuIFwiY3RhXCI6IEEgaGlnaC1jb252ZXJzaW9uIENhbGwgdG8gQWN0aW9uIGJ1dHRvbiB0ZXh0ICh1c2Ugc3Ryb25nIHZlcmJzIGxpa2UgXCJTdGFydCBGcmVlXCIsIFwiR2V0IDUwJSBPZmZcIikuXG5cblJldHVybiBvbmx5IHJhdyBKU09OIGluIHRoaXMgZXhhY3QgZm9ybWF0OiBcbnsgXCJjb2xvcnNcIjogW1wiIy4uLlwiLCBcIiMuLi5cIiwgXCIjLi4uXCJdLCBcInRhZ2xpbmVcIjogXCIuLi5cIiwgXCJ2b2ljZVwiOiBbXCIuLi5cIiwgXCIuLi5cIiwgXCIuLi5cIl0sIFwidG9uZVwiOiBcIi4uLlwiLCBcImxvZ29EZXNjcmlwdGlvblwiOiBcIi4uLlwiLCBcImJyYW5kU3VtbWFyeVwiOiBcIi4uLlwiLCBcInZpc3VhbEtleXdvcmRcIjogXCIuLi5cIiwgXCJoZWFkbGluZVwiOiBcIi4uLlwiLCBcInN1YlwiOiBcIi4uLlwiLCBcImN0YVwiOiBcIi4uLlwiIH1cbmA7XG5cbiAgICAgICAgICAvLyBTZW5kIHRvIEdlbWluaSB3aXRoIGltYWdlXG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbW9kZWwuZ2VuZXJhdGVDb250ZW50KFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgaW5saW5lRGF0YToge1xuICAgICAgICAgICAgICAgIG1pbWVUeXBlOiBcImltYWdlL3BuZ1wiLFxuICAgICAgICAgICAgICAgIGRhdGE6IGJhc2U2NFNjcmVlbnNob3QsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcHJvbXB0LFxuICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gcmVzdWx0LnJlc3BvbnNlLnRleHQoKTtcblxuICAgICAgICAgIC8vIFBhcnNlIEpTT04gZnJvbSByZXNwb25zZVxuICAgICAgICAgIGxldCBhaURhdGE6IHtcbiAgICAgICAgICAgIGNvbG9yczogc3RyaW5nW107XG4gICAgICAgICAgICB0YWdsaW5lOiBzdHJpbmc7XG4gICAgICAgICAgICB2b2ljZTogc3RyaW5nW107XG4gICAgICAgICAgICB0b25lOiBzdHJpbmc7XG4gICAgICAgICAgICBsb2dvRGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gICAgICAgICAgICBicmFuZFN1bW1hcnk/OiBzdHJpbmc7XG4gICAgICAgICAgICB2aXN1YWxLZXl3b3JkPzogc3RyaW5nO1xuICAgICAgICAgICAgaGVhZGxpbmU/OiBzdHJpbmc7XG4gICAgICAgICAgICBzdWI/OiBzdHJpbmc7XG4gICAgICAgICAgICBjdGE/OiBzdHJpbmc7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBSZW1vdmUgbWFya2Rvd24gY29kZSBibG9ja3MgaWYgcHJlc2VudFxuICAgICAgICAgICAgY29uc3QganNvbk1hdGNoID0gcmVzcG9uc2VUZXh0Lm1hdGNoKFxuICAgICAgICAgICAgICAvYGBgKD86anNvbik/XFxzKihbXFxzXFxTXSo/KWBgYC9cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb25zdCBqc29uU3RyaW5nID0ganNvbk1hdGNoXG4gICAgICAgICAgICAgID8ganNvbk1hdGNoWzFdLnRyaW0oKVxuICAgICAgICAgICAgICA6IHJlc3BvbnNlVGV4dC50cmltKCk7XG4gICAgICAgICAgICBhaURhdGEgPSBKU09OLnBhcnNlKGpzb25TdHJpbmcpO1xuICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgLy8gRmFsbGJhY2sgaWYgQUkgZG9lc24ndCByZXR1cm4gdmFsaWQgSlNPTlxuICAgICAgICAgICAgYWlEYXRhID0ge1xuICAgICAgICAgICAgICBjb2xvcnM6IFtcIiM0RjQ2RTVcIiwgXCIjRjk3MzE2XCIsIFwiIzEwQjk4MVwiXSxcbiAgICAgICAgICAgICAgdGFnbGluZTogXCJCdWlsZGluZyB0aGUgZnV0dXJlLCBvbmUgcGl4ZWwgYXQgYSB0aW1lXCIsXG4gICAgICAgICAgICAgIHZvaWNlOiBbXCJJbm5vdmF0aXZlXCIsIFwiVHJ1c3R3b3J0aHlcIiwgXCJNb2Rlcm5cIl0sXG4gICAgICAgICAgICAgIHRvbmU6IFwiUHJvZmVzc2lvbmFsIHlldCBhcHByb2FjaGFibGVcIixcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gRW5zdXJlIHdlIGhhdmUgY29sb3JzXG4gICAgICAgICAgY29uc3QgZmluYWxDb2xvcnMgPVxuICAgICAgICAgICAgYWlEYXRhLmNvbG9ycyAmJiBhaURhdGEuY29sb3JzLmxlbmd0aCA+IDBcbiAgICAgICAgICAgICAgPyBhaURhdGEuY29sb3JzLnNsaWNlKDAsIDQpXG4gICAgICAgICAgICAgIDogW1wiIzRGNDZFNVwiLCBcIiNGOTczMTZcIiwgXCIjMTBCOTgxXCIsIFwiIzhCNUNGNlwiXTtcblxuICAgICAgICAgIC8vIFNURVAgNTogU2VuZCBmaW5hbCByZXN1bHRcbiAgICAgICAgICBjb25zdCBmaW5hbERhdGE6IFNjYW5SZXN1bHQgPSB7XG4gICAgICAgICAgICBsb2dvOiBsb2dvVXJsIHx8IFwi8J+agFwiLFxuICAgICAgICAgICAgY29sb3JzOiBmaW5hbENvbG9ycyxcbiAgICAgICAgICAgIHRhZ2xpbmU6IGFpRGF0YS50YWdsaW5lIHx8IFwiSW5ub3ZhdGlvbiBtZWV0cyBleGNlbGxlbmNlXCIsXG4gICAgICAgICAgICB2b2ljZTogYWlEYXRhLnZvaWNlIHx8IFtcIklubm92YXRpdmVcIiwgXCJUcnVzdHdvcnRoeVwiLCBcIk1vZGVyblwiXSxcbiAgICAgICAgICAgIHRvbmU6IGFpRGF0YS50b25lIHx8IFwiUHJvZmVzc2lvbmFsIHlldCBhcHByb2FjaGFibGVcIixcbiAgICAgICAgICAgIGxvZ29EZXNjcmlwdGlvbjogYWlEYXRhLmxvZ29EZXNjcmlwdGlvbixcbiAgICAgICAgICAgIGJyYW5kU3VtbWFyeTogYWlEYXRhLmJyYW5kU3VtbWFyeSxcbiAgICAgICAgICAgIHZpc3VhbEtleXdvcmQ6IGFpRGF0YS52aXN1YWxLZXl3b3JkLFxuICAgICAgICAgICAgaGVhZGxpbmU6IGFpRGF0YS5oZWFkbGluZSxcbiAgICAgICAgICAgIHN1YjogYWlEYXRhLnN1YixcbiAgICAgICAgICAgIGN0YTogYWlEYXRhLmN0YSxcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgY29uc3QgY29tcGxldGVNZXNzYWdlID1cbiAgICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHsgdHlwZTogXCJjb21wbGV0ZVwiLCBkYXRhOiBmaW5hbERhdGEgfSkgKyBcIlxcblwiO1xuICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShlbmNvZGVyLmVuY29kZShjb21wbGV0ZU1lc3NhZ2UpKTtcbiAgICAgICAgICBjb250cm9sbGVyLmNsb3NlKCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgLy8gQ2xlYW4gdXAgYnJvd3NlciBpZiBzdGlsbCBvcGVuXG4gICAgICAgICAgaWYgKGJyb3dzZXIpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGF3YWl0IGJyb3dzZXIuY2xvc2UoKTtcbiAgICAgICAgICAgIH0gY2F0Y2gge31cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPVxuICAgICAgICAgICAgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcIlVua25vd24gZXJyb3Igb2NjdXJyZWRcIjtcblxuICAgICAgICAgIC8vIENoZWNrIGZvciByYXRlIGxpbWl0IGVycm9yc1xuICAgICAgICAgIGlmIChcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZS5pbmNsdWRlcyhcIjQyOVwiKSB8fFxuICAgICAgICAgICAgZXJyb3JNZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJ0b28gbWFueSByZXF1ZXN0c1wiKVxuICAgICAgICAgICkge1xuICAgICAgICAgICAgY29uc3QgZXJyb3JNc2cgPVxuICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJlcnJvclwiLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6XG4gICAgICAgICAgICAgICAgICBcIkFJIGlzIGN1cnJlbnRseSBidXN5IChSYXRlIExpbWl0KS4gUGxlYXNlIHdhaXQgMzAgc2Vjb25kcyBhbmQgdHJ5IGFnYWluLlwiLFxuICAgICAgICAgICAgICB9KSArIFwiXFxuXCI7XG4gICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoZW5jb2Rlci5lbmNvZGUoZXJyb3JNc2cpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZXJyb3JNc2cgPVxuICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeSh7IHR5cGU6IFwiZXJyb3JcIiwgbWVzc2FnZTogZXJyb3JNZXNzYWdlIH0pICsgXCJcXG5cIjtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShlbmNvZGVyLmVuY29kZShlcnJvck1zZykpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb250cm9sbGVyLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKHN0cmVhbSwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcInRleHQvcGxhaW47IGNoYXJzZXQ9dXRmLThcIixcbiAgICAgICAgXCJUcmFuc2Zlci1FbmNvZGluZ1wiOiBcImNodW5rZWRcIixcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAge1xuICAgICAgICBlcnJvcjpcbiAgICAgICAgICBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFwiRmFpbGVkIHRvIHByb2Nlc3MgcmVxdWVzdFwiLFxuICAgICAgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJjaHJvbWl1bSIsIlBsYXl3cmlnaHRCbG9ja2VyIiwiR29vZ2xlR2VuZXJhdGl2ZUFJIiwicnVudGltZSIsImR5bmFtaWMiLCJQT1NUIiwicmVxdWVzdCIsImVuY29kZXIiLCJUZXh0RW5jb2RlciIsImJvZHkiLCJqc29uIiwidXJsIiwiZXJyb3IiLCJzdGF0dXMiLCJub3JtYWxpemVkVXJsIiwic3RhcnRzV2l0aCIsIlVSTCIsInN0cmVhbSIsIlJlYWRhYmxlU3RyZWFtIiwic3RhcnQiLCJjb250cm9sbGVyIiwiYnJvd3NlciIsInNlbmRTdGF0dXMiLCJzdGVwIiwibWVzc2FnZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0eXBlIiwiZW5xdWV1ZSIsImVuY29kZSIsInVzZXJBZ2VudCIsImxhdW5jaCIsImhlYWRsZXNzIiwiYXJncyIsImNvbnRleHQiLCJuZXdDb250ZXh0Iiwidmlld3BvcnQiLCJ3aWR0aCIsImhlaWdodCIsInBlcm1pc3Npb25zIiwiaWdub3JlSFRUUFNFcnJvcnMiLCJqYXZhU2NyaXB0RW5hYmxlZCIsImxvY2FsZSIsInBhZ2UiLCJuZXdQYWdlIiwiYmxvY2tlciIsImZyb21QcmVidWlsdEFkc0FuZFRyYWNraW5nIiwiZW5hYmxlQmxvY2tpbmdJblBhZ2UiLCJnb3RvIiwid2FpdFVudGlsIiwidGltZW91dCIsIndhaXRGb3JUaW1lb3V0IiwibG9nb1VybCIsIm9nSW1hZ2UiLCIkZXZhbCIsImVsIiwiZ2V0QXR0cmlidXRlIiwiY2F0Y2giLCJocmVmIiwiZmF2aWNvbiIsImxvZ29JbWciLCJldmFsdWF0ZSIsImltZ3MiLCJBcnJheSIsImZyb20iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJsb2dvSW1hZ2UiLCJmaW5kIiwiaW1nIiwiY2xhc3NOYW1lIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsImFsdCIsInNyYyIsInNjcmVlbnNob3RCdWZmZXIiLCJzY3JlZW5zaG90IiwiZnVsbFBhZ2UiLCJjbG9zZSIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJHRU1JTklfQVBJX0tFWSIsIkVycm9yIiwiZ2VuQUkiLCJtb2RlbCIsImdldEdlbmVyYXRpdmVNb2RlbCIsImJhc2U2NFNjcmVlbnNob3QiLCJ0b1N0cmluZyIsInByb21wdCIsInJlc3VsdCIsImdlbmVyYXRlQ29udGVudCIsImlubGluZURhdGEiLCJtaW1lVHlwZSIsImRhdGEiLCJyZXNwb25zZVRleHQiLCJyZXNwb25zZSIsInRleHQiLCJhaURhdGEiLCJqc29uTWF0Y2giLCJtYXRjaCIsImpzb25TdHJpbmciLCJ0cmltIiwicGFyc2UiLCJjb2xvcnMiLCJ0YWdsaW5lIiwidm9pY2UiLCJ0b25lIiwiZmluYWxDb2xvcnMiLCJsZW5ndGgiLCJzbGljZSIsImZpbmFsRGF0YSIsImxvZ28iLCJsb2dvRGVzY3JpcHRpb24iLCJicmFuZFN1bW1hcnkiLCJ2aXN1YWxLZXl3b3JkIiwiaGVhZGxpbmUiLCJzdWIiLCJjdGEiLCJjb21wbGV0ZU1lc3NhZ2UiLCJlcnJvck1lc3NhZ2UiLCJlcnJvck1zZyIsIlJlc3BvbnNlIiwiaGVhZGVycyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/scan/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@ghostery","vendor-chunks/@remusao","vendor-chunks/tldts-core","vendor-chunks/tldts-experimental","vendor-chunks/@google"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fscan%2Froute&page=%2Fapi%2Fscan%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fscan%2Froute.ts&appDir=%2FUsers%2Fpiotrostiak%2FDev%2FGridLite%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fpiotrostiak%2FDev%2FGridLite&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();